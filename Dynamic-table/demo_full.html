<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Table Standalone Demo</title>
    <link rel="stylesheet" href="dynamic-table.css"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/7.0.2/css/flag-icons.min.css" integrity="sha512-bZBu2H0+FGFz/stDN/L0k8J0G8qVsAL0ht1qg5kTwtAheiXwiRKyCq1frwfbSFSJN3jooR5kauE0YjtPzhZtJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            margin: 20px;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        .page-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            color: #1a253c;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        h2 {
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        .table-demo-container {
            margin-bottom: 40px;
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            background-color: #f8f9fa;
        }
        .table-demo-container h3 {
            margin-top: 0;
            color: #495057;
        }
        p.description {
            font-size: 0.95em;
            color: #6c757d;
            margin-bottom:15px;
        }
        /* Style to make the page scrollable */
        .extra-content {
            height: 1000px; /* Adjust as needed to ensure page scroll */
            background-color: #e9ecef;
            padding: 20px;
            margin-top: 30px;
            border-radius: 6px;
            text-align: center;
            color: #6c757d;
        }
    </style>
</head>
<body>

    <div class="page-container">
        <h1>Standalone Demo of `dynamic-table.js` & `PureChart.js`</h1>

        <div class="table-demo-container">
            <h3>Full Table (Financial Market)</h3>
            <p class="description">
                This example uses a custom rendering function for the "Index" column (links), 
                inline charts, colored and neutral percentages, 
                pagination with rows/page selector, and a fixed table header with vertical scrolling.
                It includes header multiselect filters.
            </p>
            <div id="table-market-demo"></div>
        </div>

        <div class="table-demo-container">
            <h3>Minimalist Table (Products)</h3>
            <p class="description">
                Simple table without pagination, search, or results counter.
                Uses `uniformChartHeight` for charts of the same height.
            </p>
            <div id="table-products-minimal"></div>
        </div>
         <div class="table-demo-container">
            <h3>Classic Table (Users)</h3>
            <p class="description">
                Example without charts, showing filters and sorting.
            </p>
            <div id="table-users-classic"></div>
        </div>
    </div>
    
    <div class="extra-content">
        <p>Scroll down to test sticky header behavior with dropdowns.</p>
    </div>
     
    <script src="PureChart.js"></script> 
    <script src="dynamic-table.js"></script> 

    <script>
    // JSON data directly embedded in the HTML
    const sampleData = {
      "marketData": [
        {
          "symbol": "^FCHI", "name": "CAC 40", "category": "Index", "countryCode": "fr", "exchange": "Euronext Paris", "ytd": 0.0815, "y1": 0.1230,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [74, 75, 73, 76, 75, 77],"borderColor": "rgba(54,162,235,1)","backgroundColor": "rgba(54,162,235,0.1)","fill": true}]}
        },
        {
          "symbol": "GC=F", "name": "Gold (Futures)", "category": "Commodity", "countryCode": "us", "exchange": "COMEX", "ytd": -0.0250, "y1": 0.2205, 
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [20, 20.5, 19.8, 23, 23.5, 23.2],"borderColor": "rgba(255,206,86,1)","backgroundColor": "rgba(255,206,86,0.1)","fill": true}]}
        },
        {
          "symbol": "^GSPC", "name": "S&P 500", "category": "Index", "countryCode": "us", "exchange": "NYSE", "ytd": 0.1020, "y1": 0,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [48, 49, 50, 51, 52, 52.5],"borderColor": "rgba(75,192,192,1)","backgroundColor": "rgba(75,192,192,0.1)","fill": true}]}
        },
         {
          "symbol": "BTC-USD", "name": "Bitcoin USD", "category": "Crypto", "countryCode": "de", "exchange": "CryptoCompare", "ytd": 0.6530, "y1": 1.2570, 
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [40, 45, 60, 68, 65, 69],"borderColor": "rgba(255,159,64,1)","backgroundColor": "rgba(255,159,64,0.1)","fill": true}]}
        },
        {
          "symbol": "AAPL", "name": "Apple Inc.", "category": "Stock", "countryCode": "us", "exchange": "NASDAQ", "ytd": 0.1500, "y1": 0.3000,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [170, 175, 180, 178, 185, 190],"borderColor": "rgba(153,102,255,1)","backgroundColor": "rgba(153,102,255,0.1)","fill": true}]}
        },
        {
          "symbol": "MSFT", "name": "Microsoft Corp.", "category": "Stock", "countryCode": "us", "exchange": "NASDAQ", "ytd": 0.1200, "y1": 0.2500,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [330, 335, 340, 338, 345, 350],"borderColor": "rgba(255,99,132,1)","backgroundColor": "rgba(255,99,132,0.1)","fill": true}]}
        },
        {
          "symbol": "GOOGL", "name": "Alphabet Inc.", "category": "Stock", "countryCode": "us", "exchange": "NASDAQ", "ytd": 0.1800, "y1": 0.2000,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [130, 135, 140, 138, 145, 150],"borderColor": "rgba(54,162,235,1)","backgroundColor": "rgba(54,162,235,0.1)","fill": true}]}
        },
        {
          "symbol": "^N225", "name": "Nikkei 225", "category": "Index", "countryCode": "jp", "exchange": "Tokyo SE", "ytd": 0.0500, "y1": 0.1000,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [28, 29, 27, 30, 29, 31],"borderColor": "rgba(75,192,192,1)","backgroundColor": "rgba(75,192,192,0.1)","fill": true}]}
        },
        {
          "symbol": "EURUSD=X", "name": "EUR/USD", "category": "Forex", "countryCode": "eu", "exchange": "Forex Market", "ytd": 0.0100, "y1": -0.0200,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [1.08, 1.09, 1.07, 1.10, 1.09, 1.11],"borderColor": "rgba(255,206,86,1)","backgroundColor": "rgba(255,206,86,0.1)","fill": true}]}
        },
        {
          "symbol": "CL=F", "name": "Crude Oil WTI", "category": "Commodity", "countryCode": "us", "exchange": "NYMEX", "ytd": 0.0300, "y1": 0.1500,
          "graph": { "labels": ["J", "F", "M", "A", "M", "J"], "datasets": [{"label": "V", "values": [70, 75, 72, 78, 76, 80],"borderColor": "rgba(255,159,64,1)","backgroundColor": "rgba(255,159,64,0.1)","fill": true}]}
        },
        // Adding more unique exchanges for testing tall dropdown
        { "symbol": "TSLA", "name": "Tesla Inc.", "category": "Stock", "countryCode": "us", "exchange": "NASDAQ", "ytd": 0.50, "y1": 0.60},
        { "symbol": "AMZN", "name": "Amazon.com Inc.", "category": "Stock", "countryCode": "us", "exchange": "NASDAQ", "ytd": 0.20, "y1": 0.10},
        { "symbol": "NVDA", "name": "NVIDIA Corporation", "category": "Stock", "countryCode": "us", "exchange": "NASDAQ", "ytd": 1.50, "y1": 2.00},
        { "symbol": "BABA", "name": "Alibaba Group", "category": "Stock", "countryCode": "cn", "exchange": "NYSE", "ytd": -0.10, "y1": -0.20},
        { "symbol": "HSBC", "name": "HSBC Holdings", "category": "Bank", "countryCode": "gb", "exchange": "LSE", "ytd": 0.05, "y1": 0.08},
        { "symbol": "PHIA", "name": "Philips", "category": "Conglomerate", "countryCode": "nl", "exchange": "Euronext Amsterdam", "ytd": 0.02, "y1": 0.01},
        { "symbol": "AIR", "name": "Airbus SE", "category": "Aerospace", "countryCode": "fr", "exchange": "Euronext Paris", "ytd": 0.12, "y1": 0.15},
        { "symbol": "SIE", "name": "Siemens AG", "category": "Industrial", "countryCode": "de", "exchange": "Frankfurt SE", "ytd": 0.07, "y1": 0.09},
        { "symbol": "BMW", "name": "BMW Group", "category": "Automotive", "countryCode": "de", "exchange": "Frankfurt SE", "ytd": 0.04, "y1": 0.06},
        { "symbol": "TM", "name": "Toyota Motor", "category": "Automotive", "countryCode": "jp", "exchange": "Tokyo SE", "ytd": 0.08, "y1": 0.11},
        { "symbol": "SHEL", "name": "Shell plc", "category": "Oil & Gas", "countryCode": "gb", "exchange": "LSE", "ytd": 0.06, "y1": 0.10},
        { "symbol": "ROG", "name": "Roche Holding", "category": "Pharma", "countryCode": "ch", "exchange": "SIX Swiss Exchange", "ytd": 0.01, "y1": 0.03},
        { "symbol": "NESN", "name": "Nestle SA", "category": "Food", "countryCode": "ch", "exchange": "SIX Swiss Exchange", "ytd": -0.02, "y1": 0.00},
        { "symbol": "RIO", "name": "Rio Tinto", "category": "Mining", "countryCode": "au", "exchange": "ASX", "ytd": 0.03, "y1": 0.07},
        { "symbol": "BHP", "name": "BHP Group", "category": "Mining", "countryCode": "au", "exchange": "ASX", "ytd": 0.02, "y1": 0.05},
        { "symbol": "VALE", "name": "Vale S.A.", "category": "Mining", "countryCode": "br", "exchange": "B3", "ytd": -0.05, "y1": -0.10},
        { "symbol": "IBE", "name": "Iberdrola", "category": "Utility", "countryCode": "es", "exchange": "BME", "ytd": 0.09, "y1": 0.12},
        { "symbol": "ENEL", "name": "Enel", "category": "Utility", "countryCode": "it", "exchange": "Milan SE", "ytd": 0.07, "y1": 0.09},
        { "symbol": "ASML", "name": "ASML Holding", "category": "Tech", "countryCode": "nl", "exchange": "Euronext Amsterdam", "ytd": 0.25, "y1": 0.30}
      ],
      "productData": [
        { "productName": "Laptop Pro", "category": "Electronics", "price": 1299.99, "popularityChart": { "labels": ["W1","W2","W3"], "datasets":[{"values":[5,8,6], "backgroundColor":"#36A2EB"}] } }, // productName, category translated, labels S->W
        { "productName": "Wireless Headphones", "category": "Audio", "price": 199.00, "popularityChart": { "labels": ["W1","W2","W3"], "datasets":[{"values":[9,6,7], "backgroundColor":"#FFCE56"}] } }, // productName translated
        { "productName": "Organic Cotton T-Shirt", "category": "Apparel", "price": 29.95, "popularityChart": { "labels": ["W1","W2","W3"], "datasets":[{"values":[7,7,9], "backgroundColor":"#4BC0C0"}] } } // productName, category translated
      ],
      "userData": [
        { "id": 1, "firstName": "Alice", "lastName": "Martin", "email": "alice.martin@example.com", "registrationDate": "2023-01-15", "ip_address": "192.168.1.101", "status": "Active" },
        { "id": 2, "firstName": "Bob", "lastName": "Durand", "email": "bob.durand@example.com", "registrationDate": "2023-02-20", "ip_address": "192.168.1.102", "status": "Inactive" },
        { "id": 3, "firstName": "Carla", "lastName": "Petit", "email": "carla.petit@example.com", "registrationDate": "2022-11-05", "ip_address": "192.168.1.103", "status": "Pending" },
        { "id": 4, "firstName": "David", "lastName": "Leroy", "email": "david.leroy@example.com", "registrationDate": "2023-05-10", "ip_address": "192.168.1.104", "status": "Active" },
        { "id": 5, "firstName": "Eva", "lastName": "Moreau", "email": "eva.moreau@example.com", "registrationDate": "2022-07-19", "ip_address": "192.168.1.105", "status": "Active" }
      ]
    };

    document.addEventListener('DOMContentLoaded', () => {
        // --- Configuration for the "Financial Market" table ---
        if (sampleData.marketData) {
            createDynamicTable({
                containerId: 'table-market-demo',
                jsonData: sampleData.marketData, 
                columns: [
                    {
                        key: 'countryCode', 
                        header: 'Flag',
                        format: 'flag',
                        filterable: true,
                        sortable: true,
                        headerFilterType: 'multiselect' 
                    },
                    {
                        key: 'name', 
                        header: 'Index', 
                        sortable: true,
                        filterable: true, 
                        headerFilterType: 'text', 
                        render: (value, rowData, cell) => {
                            const link = document.createElement('a');
                            link.href = rowData.symbol ? `/light/shard/${rowData.symbol}/` : '#'; 
                            link.target = '_blank';
                            const strong = document.createElement('strong');
                            strong.textContent = rowData.name || value || 'N/A'; 
                            link.appendChild(strong);
                            cell.appendChild(link);
                        }
                    },
                    { 
                        key: 'category', 
                        header: 'Category', 
                        sortable: true, 
                        filterable: true, 
                        headerFilterType: 'select'
                    },
                    { 
                        key: 'exchange', // New column for tall dropdown
                        header: 'Exchange', 
                        sortable: true, 
                        filterable: true, 
                        headerFilterType: 'multiselect'
                    },
                    { 
                        key: 'oneYearChart', 
                        header: '1 Year Chart', 
                        renderAs: 'chart',
                        chartConfig: {
                            type: 'line',
                            dataKey: 'graph', 
                            width: 180,
                            options: {
                                title: { display: false }, legend: { display: false },
                                yAxis: { display: false, beginAtZero: false }, xAxis: { display: false },
                                line: { tension: 0.4, pointRadius: 0, lineWidth: 2}, 
                                tooltip: { enabled: true }, 
                                padding: { top: 5, right: 2, bottom: 2, left: 2 }, 
                            }
                        }
                    },
                    { 
                        key: 'ytd', 
                        header: 'YTD', 
                        sortable: true,
                        filterable: true, 
                        headerFilterType: 'regex', 
                        format: 'percent:2' 
                    },
                    { 
                        key: 'y1', 
                        header: '1 Year', 
                        sortable: true, 
                        format: 'percent_neutral:2' 
                    },                
                ],
                uniformChartHeight: 45,
                rowsPerPage: 10, // Increased to show more rows initially
                rowsPerPageOptions: [5, 10, 20, 'All'], 
                showSearchControl: true,
                showResultsCount: true,
                showPagination: true, 
                showRowsPerPageSelector: true,
                tableMaxHeight: '400px', // Set a max height for table scroll testing
                defaultSortColumn: 'name',
                defaultSortDirection: 'asc',
                filterMode: 'header' 
            });
        } else {
            document.getElementById('table-market-demo').innerHTML = '<p>"marketData" not found.</p>';
        }


        // --- Configuration for the "Minimalist Products" table ---
        if (sampleData.productData) {
            createDynamicTable({
                containerId: 'table-products-minimal',
                jsonData: sampleData.productData,
                columns: [
                    { key: 'productName', header: 'Product', sortable: true }, 
                    { key: 'category', header: 'Category' }, 
                    { 
                        key: 'popularityChartDisplay', 
                        header: 'Popularity', 
                        renderAs: 'chart',
                        chartConfig: {
                            type: 'bar',
                            dataKey: 'popularityChart',
                            width: 120,
                            options: { padding: {top:2, right:2,bottom:2,left:2}, legend: {display:false}, xAxis:{display:false}, yAxis:{display:false}}
                        }
                    },
                    { key: 'price', header: 'Price', format: 'currency:EUR' } 
                ],
                uniformChartHeight: 50,
                showSearchControl: false,
                showResultsCount: false,
                showPagination: false,
                showColumnVisibilitySelector: false, 
            });
        } else {
             document.getElementById('table-products-minimal').innerHTML = '<p>"productData" not found.</p>';
        }


        // --- Configuration for the "Classic Users" table ---
        if (sampleData.userData) {
            createDynamicTable({
                containerId: 'table-users-classic',
                jsonData: sampleData.userData,
                columns: [
                    { key: 'id', header: 'ID', sortable: true },
                    { key: 'firstName', header: 'First Name', sortable: true, filterable: true, headerFilterType: 'text' }, 
                    { key: 'lastName', header: 'Last Name', sortable: true, filterable: true }, 
                    { key: 'status', header: 'Status', sortable: true, filterable: true, globalFilterType: 'multiselect' }, 
                    { key: 'email', header: 'Email', visible: false },
                    { key: 'ip_address', header: 'IP Address', visible: false },
                    { key: 'registrationDate', header: 'Registration', format: 'date:YYYY/MM/DD', sortable: true } 
                ],
                rowsPerPage: 5,
                defaultSortColumn: 'lastName',
                showPagination: true,
                showRowsPerPageSelector: false,
                showColumnVisibilitySelector: true, 
            });
        } else {
            document.getElementById('table-users-classic').innerHTML = '<p>"userData" not found.</p>'; 
        }
    });
</script>

</body>
</html>
