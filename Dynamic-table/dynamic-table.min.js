const DT_LANG_PACKS={"en-US":{errorDataNotProvided:"Configuration Error: Data not provided.",errorInvalidJsonData:"Configuration Error: Invalid jsonData.",errorInvalidData:"Error: Invalid data.",errorJsonPathNotDefined:"Error: JSON path not defined.",errorLoadingData:"Error loading data.",errorChart:"Chart Error",errorPureChartMissing:"Chart Library Missing",errorChartDataMissing:"Chart Data Missing",columnSelectorAriaLabel:"Select columns to display",columnSelectorTitle:"Select columns to display",globalSearchLabel:"Global Search:",globalSearchPlaceholder:"Search...",filterByLabel:"Filter by {columnName}:",headerFilterPlaceholder:"Filter {columnName}...",allOption:"All",allOptionWithColumn:"All {columnName}",itemsSelected:"{count} selected",resultsInfo:"{count} result(s)",rowsPerPageLabel:"Rows/page:",allRowsOptionLabel:"All",previousButtonLabel:"Previous",nextButtonLabel:"Next",pageInfo:"Page {currentPage} / {totalPages}",loadingMsg:"Loading...",noResultsMsg:"No results found."},"fr-FR":{errorDataNotProvided:"Erreur de configuration : Donn\xe9es non fournies.",errorInvalidJsonData:"Erreur de configuration : Donn\xe9es jsonData invalides.",errorInvalidData:"Erreur : Donn\xe9es invalides.",errorJsonPathNotDefined:"Erreur : Chemin JSON non d\xe9fini.",errorLoadingData:"Erreur lors du chargement des donn\xe9es.",errorChart:"Erreur de graphique",errorPureChartMissing:"Biblioth\xe8que de graphiques manquante",errorChartDataMissing:"Donn\xe9es de graphique manquantes",columnSelectorAriaLabel:"S\xe9lectionner les colonnes \xe0 afficher",columnSelectorTitle:"Afficher/Masquer les colonnes",globalSearchLabel:"Recherche globale :",globalSearchPlaceholder:"Rechercher...",filterByLabel:"Filtrer par {columnName} :",headerFilterPlaceholder:"Filtrer {columnName}...",allOption:"Tous",allOptionWithColumn:"Tous {columnName}",itemsSelected:"{count} s\xe9lectionn\xe9(s)",resultsInfo:"{count} r\xe9sultat(s)",rowsPerPageLabel:"Lignes/page :",allRowsOptionLabel:"Toutes",previousButtonLabel:"Pr\xe9c\xe9dent",nextButtonLabel:"Suivant",pageInfo:"Page {currentPage} / {totalPages}",loadingMsg:"Chargement...",noResultsMsg:"Aucun r\xe9sultat trouv\xe9."},"es-ES":{errorDataNotProvided:"Error de configuraci\xf3n: Datos no proporcionados.",errorInvalidJsonData:"Error de configuraci\xf3n: jsonData no v\xe1lido.",errorInvalidData:"Error: Datos no v\xe1lidos.",errorJsonPathNotDefined:"Error: Ruta JSON no definida.",errorLoadingData:"Error al cargar los datos.",errorChart:"Error del gr\xe1fico",errorPureChartMissing:"Falta la librer\xeda de gr\xe1ficos",errorChartDataMissing:"Faltan datos del gr\xe1fico",columnSelectorAriaLabel:"Seleccionar columnas para mostrar",columnSelectorTitle:"Seleccionar columnas para mostrar",globalSearchLabel:"B\xfasqueda global:",globalSearchPlaceholder:"Buscar...",filterByLabel:"Filtrar por {columnName}:",headerFilterPlaceholder:"Filtrar {columnName}...",allOption:"Todo",allOptionWithColumn:"Todas las {columnName}",itemsSelected:"{count} seleccionado(s)",resultsInfo:"{count} resultado(s)",rowsPerPageLabel:"Filas por p\xe1gina:",allRowsOptionLabel:"Todas",previousButtonLabel:"Anterior",nextButtonLabel:"Siguiente",pageInfo:"P\xe1gina {currentPage} / {totalPages}",loadingMsg:"Cargando...",noResultsMsg:"No se encontraron resultados."},"it-IT":{errorDataNotProvided:"Errore di configurazione: Dati non forniti.",errorInvalidJsonData:"Errore di configurazione: jsonData non valido.",errorInvalidData:"Errore: Dati non validi.",errorJsonPathNotDefined:"Errore: Percorso JSON non definito.",errorLoadingData:"Errore durante il caricamento dei dati.",errorChart:"Errore grafico",errorPureChartMissing:"Libreria grafica mancante",errorChartDataMissing:"Dati del grafico mancanti",columnSelectorAriaLabel:"Seleziona colonne da visualizzare",columnSelectorTitle:"Seleziona colonne da visualizzare",globalSearchLabel:"Ricerca globale:",globalSearchPlaceholder:"Cerca...",filterByLabel:"Filtra per {columnName}:",headerFilterPlaceholder:"Filtra {columnName}...",allOption:"Tutti",allOptionWithColumn:"Tutti i {columnName}",itemsSelected:"{count} selezionato(i)",resultsInfo:"{count} risultato(i)",rowsPerPageLabel:"Righe per pagina:",allRowsOptionLabel:"Tutte",previousButtonLabel:"Precedente",nextButtonLabel:"Successivo",pageInfo:"Pagina {currentPage} / {totalPages}",loadingMsg:"Caricamento...",noResultsMsg:"Nessun risultato trovato."},"de-DE":{errorDataNotProvided:"Konfigurationsfehler: Daten nicht bereitgestellt.",errorInvalidJsonData:"Konfigurationsfehler: Ung\xfcltige jsonData.",errorInvalidData:"Fehler: Ung\xfcltige Daten.",errorJsonPathNotDefined:"Fehler: JSON-Pfad nicht definiert.",errorLoadingData:"Fehler beim Laden der Daten.",errorChart:"Diagrammfehler",errorPureChartMissing:"Diagrammbibliothek fehlt",errorChartDataMissing:"Diagrammdaten fehlen",columnSelectorAriaLabel:"Spalten zur Anzeige ausw\xe4hlen",columnSelectorTitle:"Spalten zur Anzeige ausw\xe4hlen",globalSearchLabel:"Globale Suche:",globalSearchPlaceholder:"Suchen...",filterByLabel:"Filtern nach {columnName}:",headerFilterPlaceholder:"{columnName} filtern...",allOption:"Alle",allOptionWithColumn:"Alle {columnName}",itemsSelected:"{count} ausgew\xe4hlt",resultsInfo:"{count} Ergebnis(se)",rowsPerPageLabel:"Zeilen pro Seite:",allRowsOptionLabel:"Alle",previousButtonLabel:"Zur\xfcck",nextButtonLabel:"Weiter",pageInfo:"Seite {currentPage} / {totalPages}",loadingMsg:"Wird geladen...",noResultsMsg:"Keine Ergebnisse gefunden."}};function createDynamicTable(e){let{containerId:t,jsonPath:l,jsonData:a,columns:r=[],defaultSortColumn:n=null,defaultSortDirection:o="asc",showSearchControl:i=!0,showResultsCount:s=!0,showPagination:c=!0,showRowsPerPageSelector:d=!0,rowsPerPageOptions:u=[10,25,50,100,"All"],tableMaxHeight:m=null,uniformChartHeight:p=null,showColumnVisibilitySelector:h=!0,language:f="en-US"}=e,g=DT_LANG_PACKS[f]||DT_LANG_PACKS["en-US"],y=e.filterMode||"global",C=void 0!==e.rowsPerPage?e.rowsPerPage:u[0]||10,b,v=e=>"all"===String(e).toLowerCase()||"tout"===String(e).toLowerCase();if(v(C)||"infinity"===String(C).toLowerCase())b=1/0;else if(isNaN(b=Number(C))||b<=0){let E=u.find(e=>Number(e)>0||v(e)||"infinity"===String(e).toLowerCase());b=E?v(E)||"infinity"===String(E).toLowerCase()?1/0:Number(E):10}let L=document.getElementById(t);if(!L){console.error(`[DynamicTable] Error: Container with ID "${t}" not found.`);return}if(!l&&!a){console.error("[DynamicTable] Error: jsonPath or jsonData must be provided."),L.innerHTML=`<p style="color:red;">${g.errorDataNotProvided}</p>`;return}if(a&&!Array.isArray(a)){console.error("[DynamicTable] Error: jsonData must be an array."),L.innerHTML=`<p style="color:red;">${g.errorInvalidJsonData}</p>`;return}if(!Array.isArray(r)||0===r.length){console.error("[DynamicTable] Error: Columns definition (columns) is invalid.");return}let $=[],S=[],D=1,N=n,k=o,P=[],w=[],T,_,x,M,F,A,I={},O,q,H,B,R,W,K;function J(e){let t="";for(let l of e)"*"===l?t+=".*":"?"===l?t+=".":/[.+(){}\[\]\\^$|]/.test(l)?t+="\\"+l:t+=l;return t}function U(){return P.filter(e=>e.visible).length}function z(){if(!x)return;x.innerHTML="";let e=x.insertRow();P.forEach(t=>{if(t.visible){let l=r.find(e=>e.key===t.key),a=document.createElement("th");a.setAttribute("scope","col");let n=document.createElement("div");n.className="dt-title-line";let o=document.createElement("span");if(o.className="dt-header-text",o.textContent=t.header,n.appendChild(o),a.appendChild(n),l&&l.sortable&&l.key&&(a.classList.add("sortable"),a.dataset.column=l.key),"header"===y&&l&&l.filterable){let i=document.createElement("div");i.className="dt-header-filter-placeholder";let s=l.headerFilterType||null;if(s)switch(i.innerHTML="",s){case"text":case"regex":let c=document.createElement("input");c.type="text",c.placeholder=g.headerFilterPlaceholder.replace("{columnName}",t.header),c.className="dt-header-filter-input",c.dataset.columnKey=t.key,c.addEventListener("click",e=>e.stopPropagation()),c.addEventListener("input",()=>{Q()}),i.appendChild(c);break;case"select":let d=document.createElement("select");d.className="dt-header-filter-select",d.dataset.columnKey=t.key;let u=document.createElement("option");u.value="",u.textContent=g.allOption,d.appendChild(u),d.addEventListener("change",()=>{Q()}),i.appendChild(d);break;case"multiselect":let m=document.createElement("div");m.className="dt-header-multiselect",m.dataset.columnKey=t.key;let p=document.createElement("div");p.className="dt-multiselect-trigger";let h=document.createElement("span");h.className="dt-multiselect-value",h.textContent=g.allOption;let f=document.createElement("span");f.className="dt-multiselect-arrow",f.innerHTML="&#9660;",p.appendChild(h),p.appendChild(f);let C=document.createElement("div");C.className="dt-multiselect-dropdown",C.style.display="none",m.appendChild(p),m.appendChild(C),m.addEventListener("click",e=>e.stopPropagation()),p.addEventListener("click",e=>{let t="block"===C.style.display;x&&x.querySelectorAll(".dt-header-multiselect .dt-multiselect-dropdown").forEach(e=>{e!==C&&(e.style.display="none")}),C.style.display=t?"none":"block"}),i.appendChild(m)}a.appendChild(i)}e.appendChild(a)}}),el()}function j(e){if("string"!=typeof e||!e.trim())return"";let t=e.trim().toLowerCase();return t.startsWith("fi-")&&(t=t.substring(3)),t}function G(e){if(!e||2!==e.length)return"";let t=e.toUpperCase().split("").map(e=>127462+(e.charCodeAt(0)-65));return String.fromCodePoint(...t)}function Y(e){if(!Array.isArray($=e)){console.error(`[DynamicTable ${t}] Error: Provided data is not an array.`);let l=U();M&&(M.innerHTML=`<tr><td colspan="${l>0?l:1}" class="message-row error">${g.errorInvalidData}</td></tr>`);return}X(),Q()}async function V(){if(!l){console.error(`[DynamicTable ${t}] Error: jsonPath not defined.`);let e=U();M&&(M.innerHTML=`<tr><td colspan="${e>0?e:1}" class="message-row error">${g.errorJsonPathNotDefined}</td></tr>`);return}!function e(){let t=U();M&&(M.innerHTML=`<tr><td colspan="${t>0?t:1}" class="message-row loading">${g.loadingMsg}</td></tr>`)}();try{let a=await fetch(l);if(!a.ok)throw Error(`HTTP ${a.status}: ${a.statusText}`);let r=await a.json();Y(r)}catch(n){console.error(`[DynamicTable ${t}] Fetch error:`,n);let o=U();M&&(M.innerHTML=`<tr><td colspan="${o>0?o:1}" class="message-row error">${g.errorLoadingData}</td></tr>`),A&&(A.disabled=!0),Object.values(I).forEach(e=>e.disabled=!0),H&&(H.disabled=!0),B&&(B.disabled=!0),W&&(W.disabled=!0)}}function Z(e,t=null){let l=e.querySelectorAll('.dt-multiselect-item input[type="checkbox"]:checked'),a=e.querySelector(".dt-multiselect-value")||e.querySelector(".dt-custom-select-value");if(a){if(0===l.length)a.textContent=t?g.allOptionWithColumn.replace("{columnName}",t):g.allOption;else if(l.length<=2){let r=[];l.forEach(e=>r.push(e.value)),a.textContent=r.join(", ")}else a.textContent=g.itemsSelected.replace("{count}",l.length)}}function X(){Object.entries(I).forEach(([e,l])=>{let a=r.find(t=>t.key===e),n=a?a.header:"";if(l.custom&&l.isGlobalMultiSelect){let o=l.optionsContainer;if(o&&$.length>0){o.innerHTML="";let i=[...new Set($.map(t=>t[e]))].filter(e=>null!=e&&""!==String(e).trim()).sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:String(e).localeCompare(String(t)));i.forEach(a=>{let r=`dt-gms-${t}-${e}-${String(a).replace(/\s+/g,"-")}`,i=document.createElement("div");i.className="dt-multiselect-item";let s=document.createElement("input");s.type="checkbox",s.id=r,s.value=a,s.dataset.filterKey=e;let c=document.createElement("label");c.htmlFor=r,c.textContent=a,i.appendChild(s),i.appendChild(c),o.appendChild(i),s.addEventListener("change",()=>{let t=o.querySelectorAll('input[type="checkbox"]:checked'),a=[];t.forEach(e=>a.push(e.value)),I[e].value=a,Z(l.mainElement,n),Q()})}),Z(l.mainElement,n)}}else if(l.custom){let s=[...new Set($.map(t=>j(t[e])))].filter(Boolean).sort();(function e(t,l,a,r,n){l.innerHTML="";let o=document.createElement("div");o.className="dt-custom-option",o.textContent=g.allOption,o.dataset.value="",o.addEventListener("click",()=>{a.textContent=g.allOption,I[t].value="",l.style.display="none",l.closest(".dt-custom-select").classList.remove("open"),Q()}),l.appendChild(o),r.forEach(e=>{let r=document.createElement("div");r.className="dt-custom-option",r.dataset.value=e,r.innerHTML=`<span class="fi fi-${e}"></span>`,r.addEventListener("click",()=>{a.innerHTML=`<span class="fi fi-${e}"></span>`,I[t].value=e,l.style.display="none",l.closest(".dt-custom-select").classList.remove("open"),Q()}),l.appendChild(r)})})(e,l.optionsContainer,l.triggerValueElement,s,n)}else{let c=l.element;if(c){for(;c.options.length>1;)c.remove(1);let d=[...new Set($.map(t=>t[e]))].sort();d.forEach(e=>{if(null!=e){let t=document.createElement("option");t.value=e,t.textContent=e,c.appendChild(t)}})}}}),x&&$.length>0&&r.forEach(e=>{if(e.filterable&&e.key){if("select"===e.headerFilterType){let l=x.querySelector(`.dt-header-filter-select[data-column-key="${e.key}"]`);if(l){for(;l.options.length>1;)l.remove(1);let a=[...new Set($.map(t=>t[e.key]))].filter(e=>null!=e&&""!==String(e).trim()).sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:String(e).localeCompare(String(t)));a.forEach(e=>{let t=document.createElement("option");t.value=e,t.textContent=e,l.appendChild(t)})}}else if("multiselect"===e.headerFilterType){let r=x.querySelector(`.dt-header-multiselect[data-column-key="${e.key}"]`);if(r){let n=r.querySelector(".dt-multiselect-dropdown");if(n){n.innerHTML="";let o=[...new Set($.map(t=>t[e.key]))].filter(e=>null!=e&&""!==String(e).trim()).sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:String(e).localeCompare(String(t)));o.forEach(l=>{let a=`dt-ms-${t}-${e.key}-${String(l).replace(/\s+/g,"-")}`,o=document.createElement("div");o.className="dt-multiselect-item";let i=document.createElement("input");i.type="checkbox",i.id=a,i.value=l,i.dataset.columnKey=e.key;let s=document.createElement("label");s.htmlFor=a,s.textContent=l,o.appendChild(i),o.appendChild(s),n.appendChild(o),i.addEventListener("change",()=>{Z(r),Q()})}),Z(r)}}}}})}function Q(){let e;if("header"===y){let t={};x&&r.forEach(e=>{if(e.filterable&&e.headerFilterType&&e.key){let l=e.key;switch(e.headerFilterType){case"text":case"regex":let a=x.querySelector(`.dt-header-filter-input[data-column-key="${l}"]`);a&&a.value.trim()&&(t[l]={value:a.value.trim(),type:e.headerFilterType});break;case"select":let r=x.querySelector(`.dt-header-filter-select[data-column-key="${l}"]`);r&&r.value&&(t[l]={value:r.value,type:"select"});break;case"multiselect":let n=x.querySelector(`.dt-header-multiselect[data-column-key="${l}"]`);if(n){let o=n.querySelectorAll('.dt-multiselect-item input[type="checkbox"]:checked');if(o.length>0){let i=[];o.forEach(e=>i.push(e.value)),t[l]={values:i,type:"multiselect"}}}}}}),e=$.filter(e=>{for(let l in t){r.find(e=>e.key===l);let a=e[l],n=t[l],o=n.value,i=String(null!=a?a:"");if("text"===n.type||"regex"===n.type){let s=J(o);try{let c=RegExp(s,"i");if(!c.test(i))return!1}catch(d){return console.warn(`[DynamicTable] Invalid pattern/regex for column ${l}: ${o} (converted to ${s})`,d),!1}}else if("select"===n.type){if(i!==o)return!1}else if("multiselect"===n.type&&n.values&&n.values.length>0&&!n.values.includes(i))return!1}return!0})}else{let l=A&&i?A.value.trim().toLowerCase():"",a={};Object.entries(I).forEach(([e,t])=>{t.custom?t.value&&(a[e]=t.value):t.element&&t.element.value&&(a[e]=t.element.value)}),e=$.filter(e=>{let t=Object.entries(a).every(([t,l])=>{let a=r.find(e=>e.key===t),n=String(null!==e[t]&&void 0!==e[t]?e[t]:"");if(a&&"multiselect"===a.globalFilterType)return!Array.isArray(l)||!(l.length>0)||l.includes(n);if(a&&"flag"===a.format){let o=j(e[t]);return String(o)===l}return n===l});return!!t&&(!i||!l||Object.values(e).some(e=>String(null!=e?e:"").toLowerCase().includes(l)))})}N&&e.sort((e,t)=>{let l=e[N],a=t[N],r=parseFloat(l),n=parseFloat(a);return(isNaN(r)||isNaN(n)||"boolean"==typeof l||"boolean"==typeof a?(l=String(l).toLowerCase(),a=String(a).toLowerCase()):(l=r,a=n),l<a)?"asc"===k?-1:1:l>a?"asc"===k?1:-1:0}),S=e,D=1,ee()}function ee(){if(!M)return;if(w&&w.length>0&&w.forEach(e=>{e&&"function"==typeof e._onMouseOut&&e._onMouseOut(),e&&e.tooltipElement&&e.tooltipElement.parentNode&&e.tooltipElement.parentNode.removeChild(e.tooltipElement)}),w=[],M.innerHTML="",0===S.length){!function e(){let t=U();M&&(M.innerHTML=`<tr><td colspan="${t>0?t:1}" class="message-row no-results">${g.noResultsMsg}</td></tr>`)}(),c&&et(),O&&(O.textContent="0");return}let e;e=c?b===1/0?S.length:Number(b):S.length;let l=0===e&&S.length>0?1:Math.ceil(S.length/e);D=Math.max(1,Math.min(D,l));let a=(D-1)*e,n=Math.min(a+e,S.length),o=S.slice(a,n);if(o.forEach((e,l)=>{let n=M.insertRow();P.forEach((o,i)=>{if(o.visible){let s=r.find(e=>e.key===o.key);if(!s){console.warn(`[DynamicTable] Column config not found for key: ${o.key}`);return}let c=n.insertCell();c.innerHTML="","string"==typeof s.format&&(s.format.startsWith("currency:")?c.classList.add("dt-currency-cell"):s.format.startsWith("percent")&&c.classList.add("dt-percentage-cell"));let d=e[s.key];if("function"==typeof s.render)s.render(d,e,c);else if("chart"===s.renderAs&&s.chartConfig){c.classList.add("dt-chart-cell");let u=document.createElement("div");u.className="dt-chart-canvas-wrapper";let m=s.chartConfig.width||150;u.style.minWidth=m+"px",c.appendChild(u);let h=`${t}-chart-${a+l}-${i}`,f=document.createElement("canvas");f.id=h,f.width=s.chartConfig.width||150,f.height=p||s.chartConfig.height||75,u.appendChild(f);let y=e[s.chartConfig.dataKey];if(y&&"undefined"!=typeof PureChart)try{let C=new PureChart(h,{type:s.chartConfig.type,data:y,options:s.chartConfig.options||{}});C&&w.push(C)}catch(b){console.error(`[DynamicTable] Error creating chart ${h}:`,b),c.textContent=g.errorChart}else"undefined"==typeof PureChart?(console.warn(`[DynamicTable] PureChart is not defined for column ${s.header}. Ensure PureChart.js is loaded.`),c.textContent=g.errorPureChartMissing):(console.warn(`[DynamicTable] Data for chart not found via dataKey '${s.chartConfig.dataKey}' for column ${s.header}.`),c.textContent=g.errorChartDataMissing)}else{let v=function e(t,l){if(null==t)return"";if("number"!=typeof t&&(String(l).startsWith("currency:")||String(l).startsWith("percent")))return t;if("string"==typeof l){if(l.startsWith("currency:")){let a=l.split(":"),r=a[1]?a[1].toUpperCase():"EUR",n="USD"===r?"en-US":"en-GB";a[2]&&(n=a[2]);try{return t.toLocaleString("en-US",{style:"currency",currency:r,useGrouping:!0}).replace(/,/g," ")}catch(o){return console.warn(`[DynamicTable] Currency formatting error for ${r} with locale 'en-US':`,o),t}}if(l.startsWith("percent")){let i=l.includes("_neutral");if(i&&0===t)return"";let s=l.replace("_neutral","").split(":"),c=s[1]?parseInt(s[1],10):0;return isNaN(c)||c<0?(100*t).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).replace(/,/g," ")+"%":(100*t).toLocaleString("en-US",{minimumFractionDigits:c,maximumFractionDigits:c}).replace(/,/g," ")+"%"}if("date:YYYY/MM/DD"===l){let d=new Date(t);if(!isNaN(d.getTime())){let u=d.getFullYear(),m=("0"+(d.getMonth()+1)).slice(-2),p=("0"+d.getDate()).slice(-2);return`${u}/${m}/${p}`}return t}if("date"===l){let h=new Date(t);return isNaN(h.getTime())?t:h.toLocaleDateString("en-US")}if("flag"===l){if("string"==typeof t&&""!==t.trim()){let f=t.trim().toLowerCase();if(f.startsWith("fi-")&&(f=f.substring(3)),f.length>=2)return`<span class="fi fi-${f}"></span>`}return""}}return t}(d,s.format);"string"==typeof s.format&&s.format.startsWith("percent_neutral")&&"number"==typeof d&&0===d?c.innerHTML="":"flag"===s.format?c.innerHTML=v:c.textContent=v,"string"==typeof s.format&&s.format.startsWith("percent")&&!s.format.includes("_neutral")&&"number"==typeof d&&(c.classList.remove("dt-value-positive","dt-value-negative"),d>0?c.classList.add("dt-value-positive"):d<=0&&c.classList.add("dt-value-negative"))}}})}),c&&et(),O&&O.parentNode){let i=S.length.toLocaleString("en-US");i=i.replace(/,/g," "),O.textContent=i;let s=O.nextSibling;s&&s.nodeType===Node.TEXT_NODE&&(s.textContent=` ${g.resultsInfo.replace("{count}","")}`)}}function et(){if(!c||!R||!H||!B)return;let e=b===1/0?S.length:Number(b),t=S.length,l;if(D=Math.max(1,Math.min(D,l=0===t?1:0===e?1:e>=t&&t>0?1:Math.ceil(t/e))),R.textContent=g.pageInfo.replace("{currentPage}",D).replace("{totalPages}",l),H.disabled=1===D,B.disabled=D===l||0===t,W){let a=b===1/0?"Infinity":String(b);for(let r=0;r<W.options.length;r++)if(W.options[r].value.toLowerCase()===a.toLowerCase()){W.selectedIndex=r;break}}}function el(){x&&x.querySelectorAll("th.sortable").forEach(e=>{let t=e.querySelector(".sort-arrow");if(t&&t.remove(),e.dataset.column===N){let l=document.createElement("span");l.className="sort-arrow "+k;let a=e.querySelector(".dt-title-line");a?a.appendChild(l):e.appendChild(l)}})}r.forEach(e=>{P.push({key:e.key,header:e.header,visible:void 0===e.visible||e.visible})}),!function e(){L.innerHTML="",L.classList.add("dynamic-table-wrapper"),(F=document.createElement("div")).className="dynamic-table-controls";let l=!1,a;if(i){(a=document.createElement("div")).className="dynamic-table-search-control";let n=document.createElement("label");n.htmlFor=`${t}-global-search`,n.textContent=g.globalSearchLabel,(A=document.createElement("input")).type="search",A.id=`${t}-global-search`,A.placeholder=g.globalSearchPlaceholder,a.appendChild(n),a.appendChild(A),F.appendChild(a),l=!0}let o=[];r.forEach(e=>{if(e.filterable&&e.key){let a=document.createElement("div");a.className="dynamic-table-filter-control";let r=document.createElement("label");r.htmlFor=`${t}-filter-${e.key}`,r.textContent=g.filterByLabel.replace("{columnName}",e.header),a.appendChild(r);let n=e.globalFilterType||"select";if("multiselect"===n){let i=document.createElement("div");i.className="dt-global-multiselect dt-custom-select",i.dataset.filterKey=e.key;let s=document.createElement("div");s.className="dt-custom-select-trigger";let c=document.createElement("span");c.className="dt-custom-select-value",c.textContent=g.allOptionWithColumn.replace("{columnName}",e.header);let d=document.createElement("span");d.className="dt-custom-arrow",d.innerHTML="&#9660;",s.appendChild(c),s.appendChild(d);let u=document.createElement("div");u.className="dt-custom-options",u.style.display="none",i.appendChild(s),i.appendChild(u),a.appendChild(i),I[e.key]={custom:!0,isGlobalMultiSelect:!0,mainElement:i,triggerValueElement:c,optionsContainer:u,value:[]}}else if("flag"===e.format){a.classList.add("custom-flag-filter");let m=document.createElement("div");m.id=`${t}-filter-${e.key}`,m.className="dt-custom-select",m.dataset.filterKey=e.key;let p=document.createElement("div");p.className="dt-custom-select-trigger";let h=document.createElement("span");h.className="dt-custom-select-value",h.textContent=g.allOption,p.appendChild(h);let f=document.createElement("span");f.className="dt-custom-arrow",f.innerHTML="&#9660;",p.appendChild(f),m.appendChild(p);let y=document.createElement("div");y.className="dt-custom-options",y.style.display="none",m.appendChild(y),a.appendChild(m),I[e.key]={custom:!0,isGlobalMultiSelect:!1,mainElement:m,triggerValueElement:h,optionsContainer:y,value:""}}else{let C=document.createElement("select");C.id=`${t}-filter-${e.key}`,C.dataset.filterKey=e.key,C.classList.add("dt-common-select");let b=document.createElement("option");b.value="",b.textContent=g.allOptionWithColumn.replace("{columnName}",e.header),C.appendChild(b),a.appendChild(C),I[e.key]={custom:!1,isGlobalMultiSelect:!1,element:C}}F.appendChild(a),o.push(a),l=!0}}),"header"===y&&(a&&(a.style.display="none"),o.forEach(e=>{e.style.display="none"}));let p=document.createElement("div");p.className="dynamic-table-right-controls-group";let f=!1;if(s){let C=document.createElement("div");C.className="dynamic-table-results-info",(O=document.createElement("strong")).textContent="0",C.appendChild(O);let E=document.createTextNode("");C.appendChild(E),p.appendChild(C),f=!0}if(h&&(K=function e(){let l=document.createElement("div");l.className="dynamic-table-column-selector";let a=document.createElement("button");a.innerHTML="&#x2699;",a.className="dt-column-selector-button",a.setAttribute("aria-label",g.columnSelectorAriaLabel),a.title=g.columnSelectorTitle,l.appendChild(a);let r=document.createElement("div");return r.className="dt-column-selector-dropdown",r.style.display="none",P.forEach(e=>{let l=`${t}-col-toggle-${e.key}`,a=document.createElement("div");a.className="dt-column-selector-item";let n=document.createElement("input");n.type="checkbox",n.id=l,n.checked=e.visible,n.dataset.columnKey=e.key,n.addEventListener("change",function(){let e=this.dataset.columnKey,t=P.find(t=>t.key===e);t&&(t.visible=this.checked),z(),X(),ee()});let o=document.createElement("label");o.htmlFor=l,o.textContent=e.header,a.appendChild(n),a.appendChild(o),r.appendChild(a)}),l.appendChild(r),a.addEventListener("click",e=>{e.stopPropagation();let t="block"===r.style.display;document.querySelectorAll(".dt-column-selector-dropdown").forEach(e=>{e!==r&&(e.style.display="none")}),r.style.display=t?"none":"block"}),document.addEventListener("click",e=>{l.contains(e.target)||"block"!==r.style.display||(r.style.display="none")}),l}(),p.appendChild(K),f=!0),f&&(F.appendChild(p),l=!0),l&&L.appendChild(F),(T=document.createElement("div")).className="dynamic-table-scroll-wrapper",m&&(T.style.maxHeight=m,T.style.overflowY="auto"),(_=document.createElement("table")).className="dynamic-table",x=_.createTHead(),M=_.createTBody(),z(),T.appendChild(_),L.appendChild(T),c){(q=document.createElement("div")).className="dynamic-table-pagination";let $=document.createElement("div");if($.className="dynamic-table-pagination-left",d){let S=document.createElement("div");S.className="dynamic-table-rows-per-page-control";let D=document.createElement("label");D.htmlFor=`${t}-rows-per-page`,D.textContent=g.rowsPerPageLabel,(W=document.createElement("select")).id=`${t}-rows-per-page`,W.classList.add("dt-common-select"),u.forEach(e=>{let t=document.createElement("option"),l=v(e);t.value=l?1/0:e,t.textContent=l?g.allRowsOptionLabel:String(e),(l&&b===1/0||!l&&Number(e)===Number(b))&&(t.selected=!0),W.appendChild(t)}),S.appendChild(D),S.appendChild(W),$.appendChild(S)}q.appendChild($);let N=document.createElement("div");N.className="dynamic-table-main-pagination-controls",(H=document.createElement("button")).textContent=g.previousButtonLabel,H.disabled=!0,N.appendChild(H),(R=document.createElement("span")).textContent=g.pageInfo.replace("{currentPage}","1").replace("{totalPages}","1"),N.appendChild(R),(B=document.createElement("button")).textContent=g.nextButtonLabel,B.disabled=!0,N.appendChild(B),q.appendChild(N),L.appendChild(q)}}(),A&&A.addEventListener("input",Q),document.addEventListener("click",e=>{if(Object.values(I).forEach(t=>{t.custom&&t.mainElement.classList.contains("open")&&!t.mainElement.contains(e.target)&&(t.mainElement.classList.remove("open"),t.optionsContainer&&(t.optionsContainer.style.display="none"))}),K){let t=K.querySelector(".dt-column-selector-dropdown");t&&"block"===t.style.display&&!K.contains(e.target)&&(t.style.display="none")}x&&x.querySelectorAll(".dt-header-multiselect").forEach(t=>{let l=t.querySelector(".dt-multiselect-dropdown");l&&"block"===l.style.display&&!t.contains(e.target)&&(l.style.display="none")})}),Object.entries(I).forEach(([e,t])=>{if(t.custom){let l=t.mainElement,a=l.querySelector(".dt-custom-select-trigger"),r=t.optionsContainer;a&&r&&a.addEventListener("click",e=>{e.stopPropagation();let t=l.classList.contains("open");Object.values(I).forEach(e=>{e.custom&&e.mainElement!==l&&(e.mainElement.classList.remove("open"),e.optionsContainer&&(e.optionsContainer.style.display="none"))}),l.classList.toggle("open",!t),r.style.display=t?"none":"block"})}else t.element&&t.element.addEventListener("change",Q)}),W&&W.addEventListener("change",function(){let e=this.value;if("infinity"===e.toLowerCase())b=1/0;else if(isNaN(b=parseInt(e,10))||b<=0){let t=u[0];(b=v(t)||"infinity"===String(t).toLowerCase()?1/0:Number(t)||10)===1/0&&S&&S.length>0||b===1/0&&(b=10)}D=1,ee()}),x&&x.addEventListener("click",e=>{let t=e.target,l=t.closest("th.sortable");if(!l||t.closest(".dt-header-filter-placeholder"))return;let a=l.dataset.column;a&&(N===a?k="asc"===k?"desc":"asc":(N=a,k="asc"),el(),Q())}),H&&H.addEventListener("click",()=>{D>1&&(D--,ee())}),B&&B.addEventListener("click",()=>{let e=b===1/0?S.length:Number(b),t=1;S.length>0&&e>0?t=Math.ceil(S.length/e):0===S.length&&(t=1),D<t&&(D++,ee())}),a?Y(a):l&&V()}
