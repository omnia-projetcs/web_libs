const DT_LANG_PACKS={"en-US":{errorDataNotProvided:"Configuration Error: Data not provided.",errorInvalidJsonData:"Configuration Error: Invalid jsonData.",errorInvalidData:"Error: Invalid data.",errorJsonPathNotDefined:"Error: JSON path not defined.",errorLoadingData:"Error loading data.",errorChart:"Chart Error",errorPureChartMissing:"Chart Library Missing",errorChartDataMissing:"Chart Data Missing",columnSelectorAriaLabel:"Select columns to display",columnSelectorTitle:"Select columns to display",globalSearchLabel:"Global Search:",globalSearchPlaceholder:"Search...",filterByLabel:"Filter by {columnName}:",headerFilterPlaceholder:"Filter {columnName}...",allOption:"All",allOptionWithColumn:"All {columnName}",itemsSelected:"{count} selected",resultsInfo:"{count} result(s)",rowsPerPageLabel:"Rows/page:",allRowsOptionLabel:"All",previousButtonLabel:"Previous",nextButtonLabel:"Next",pageInfo:"Page {currentPage} / {totalPages}",loadingMsg:"Loading...",noResultsMsg:"No results found."},"fr-FR":{errorDataNotProvided:"Erreur de configuration : Données non fournies.",errorInvalidJsonData:"Erreur de configuration : Données jsonData invalides.",errorInvalidData:"Erreur : Données invalides.",errorJsonPathNotDefined:"Erreur : Chemin JSON non défini.",errorLoadingData:"Erreur lors du chargement des données.",errorChart:"Erreur de graphique",errorPureChartMissing:"Bibliothèque de graphiques manquante",errorChartDataMissing:"Données de graphique manquantes",columnSelectorAriaLabel:"Sélectionner les colonnes à afficher",columnSelectorTitle:"Afficher/Masquer les colonnes",globalSearchLabel:"Recherche globale :",globalSearchPlaceholder:"Rechercher...",filterByLabel:"Filtrer par {columnName} :",headerFilterPlaceholder:"Filtrer {columnName}...",allOption:"Tous",allOptionWithColumn:"Tous {columnName}",itemsSelected:"{count} sélectionné(s)",resultsInfo:"{count} résultat(s)",rowsPerPageLabel:"Lignes/page :",allRowsOptionLabel:"Toutes",previousButtonLabel:"Précédent",nextButtonLabel:"Suivant",pageInfo:"Page {currentPage} / {totalPages}",loadingMsg:"Chargement...",noResultsMsg:"Aucun résultat trouvé."},"es-ES":{errorDataNotProvided:"Error de configuración: Datos no proporcionados.",errorInvalidJsonData:"Error de configuración: jsonData no válido.",errorInvalidData:"Error: Datos no válidos.",errorJsonPathNotDefined:"Error: Ruta JSON no definida.",errorLoadingData:"Error al cargar los datos.",errorChart:"Error del gráfico",errorPureChartMissing:"Falta la librería de gráficos",errorChartDataMissing:"Faltan datos del gráfico",columnSelectorAriaLabel:"Seleccionar columnas para mostrar",columnSelectorTitle:"Seleccionar columnas para mostrar",globalSearchLabel:"Búsqueda global:",globalSearchPlaceholder:"Buscar...",filterByLabel:"Filtrar por {columnName}:",headerFilterPlaceholder:"Filtrar {columnName}...",allOption:"Todo",allOptionWithColumn:"Todas las {columnName}",itemsSelected:"{count} seleccionado(s)",resultsInfo:"{count} resultado(s)",rowsPerPageLabel:"Filas por página:",allRowsOptionLabel:"Todas",previousButtonLabel:"Anterior",nextButtonLabel:"Siguiente",pageInfo:"Página {currentPage} / {totalPages}",loadingMsg:"Cargando...",noResultsMsg:"No se encontraron resultados."},"it-IT":{errorDataNotProvided:"Errore di configurazione: Dati non forniti.",errorInvalidJsonData:"Errore di configurazione: jsonData non valido.",errorInvalidData:"Errore: Dati non validi.",errorJsonPathNotDefined:"Errore: Percorso JSON non definito.",errorLoadingData:"Errore durante il caricamento dei dati.",errorChart:"Errore grafico",errorPureChartMissing:"Libreria grafica mancante",errorChartDataMissing:"Dati del grafico mancanti",columnSelectorAriaLabel:"Seleziona colonne da visualizzare",columnSelectorTitle:"Seleziona colonne da visualizzare",globalSearchLabel:"Ricerca globale:",globalSearchPlaceholder:"Cerca...",filterByLabel:"Filtra per {columnName}:",headerFilterPlaceholder:"Filtra {columnName}...",allOption:"Tutti",allOptionWithColumn:"Tutti i {columnName}",itemsSelected:"{count} selezionato(i)",resultsInfo:"{count} risultato(i)",rowsPerPageLabel:"Righe per pagina:",allRowsOptionLabel:"Tutte",previousButtonLabel:"Precedente",nextButtonLabel:"Successivo",pageInfo:"Pagina {currentPage} / {totalPages}",loadingMsg:"Caricamento...",noResultsMsg:"Nessun risultato trovato."},"de-DE":{errorDataNotProvided:"Konfigurationsfehler: Daten nicht bereitgestellt.",errorInvalidJsonData:"Konfigurationsfehler: Ungültige jsonData.",errorInvalidData:"Fehler: Ungültige Daten.",errorJsonPathNotDefined:"Fehler: JSON-Pfad nicht definiert.",errorLoadingData:"Fehler beim Laden der Daten.",errorChart:"Diagrammfehler",errorPureChartMissing:"Diagrammbibliothek fehlt",errorChartDataMissing:"Diagrammdaten fehlen",columnSelectorAriaLabel:"Spalten zur Anzeige auswählen",columnSelectorTitle:"Spalten zur Anzeige auswählen",globalSearchLabel:"Globale Suche:",globalSearchPlaceholder:"Suchen...",filterByLabel:"Filtern nach {columnName}:",headerFilterPlaceholder:"{columnName} filtern...",allOption:"Alle",allOptionWithColumn:"Alle {columnName}",itemsSelected:"{count} ausgewählt",resultsInfo:"{count} Ergebnis(se)",rowsPerPageLabel:"Zeilen pro Seite:",allRowsOptionLabel:"Alle",previousButtonLabel:"Zurück",nextButtonLabel:"Weiter",pageInfo:"Seite {currentPage} / {totalPages}",loadingMsg:"Wird geladen...",noResultsMsg:"Keine Ergebnisse gefunden."}};function createDynamicTable(e){const{containerId:t,jsonPath:n,jsonData:a,columns:r=[],defaultSortColumn:o=null,defaultSortDirection:l="asc",showSearchControl:i=!0,showResultsCount:s=!0,showPagination:c=!0,showRowsPerPageSelector:d=!0,rowsPerPageOptions:u=[10,25,50,100,"All"],tableMaxHeight:m=null,uniformChartHeight:p=null,showColumnVisibilitySelector:h=!0,language:f="en-US"}=e,g=DT_LANG_PACKS[f]||DT_LANG_PACKS["en-US"],y=e.filterMode||"global";let b,C=void 0!==e.rowsPerPage?e.rowsPerPage:u[0]||10;const v=e=>"all"===String(e).toLowerCase()||"tout"===String(e).toLowerCase();if(v(C)||"infinity"===String(C).toLowerCase())b=1/0;else if(b=Number(C),isNaN(b)||b<=0){const e=u.find((e=>Number(e)>0||v(e)||"infinity"===String(e).toLowerCase()));b=e?v(e)||"infinity"===String(e).toLowerCase()?1/0:Number(e):10}const E=document.getElementById(t);if(!E)return void console.error(`[DynamicTable] Error: Container with ID "${t}" not found.`);if(!n&&!a)return console.error("[DynamicTable] Error: jsonPath or jsonData must be provided."),void(E.innerHTML=`<p style="color:red;">${g.errorDataNotProvided}</p>`);if(a&&!Array.isArray(a))return console.error("[DynamicTable] Error: jsonData must be an array."),void(E.innerHTML=`<p style="color:red;">${g.errorInvalidJsonData}</p>`);if(!Array.isArray(r)||0===r.length)return void console.error("[DynamicTable] Error: Columns definition (columns) is invalid.");let L,S,N,D,P,w,k,T,M,x,$,F,A,O=[],I=[],q=1,H=o,B=l,R=[],j=[],K={};function W(e){let t="";for(const n of e)"*"===n?t+=".*":"?"===n?t+=".":/[.+(){}\[\]\\^$|]/.test(n)?t+="\\"+n:t+=n;return t}function J(){return R.filter((e=>e.visible)).length}function U(){if(!N)return;N.innerHTML="";const e=N.insertRow();R.forEach((t=>{if(t.visible){const n=r.find((e=>e.key===t.key)),a=document.createElement("th");a.setAttribute("scope","col");const o=document.createElement("div");o.className="dt-title-line";const l=document.createElement("span");if(l.className="dt-header-text",l.textContent=t.header,o.appendChild(l),a.appendChild(o),n&&n.sortable&&n.key&&(a.classList.add("sortable"),a.dataset.column=n.key),"header"===y&&n&&n.filterable){const e=document.createElement("div");e.className="dt-header-filter-placeholder";const r=n.headerFilterType||null;if(r)switch(e.innerHTML="",r){case"text":case"regex":const n=document.createElement("input");n.type="text",n.placeholder=g.headerFilterPlaceholder.replace("{columnName}",t.header),n.className="dt-header-filter-input",n.dataset.columnKey=t.key,n.addEventListener("click",(e=>e.stopPropagation())),n.addEventListener("input",(()=>{V()})),e.appendChild(n);break;case"select":const a=document.createElement("select");a.className="dt-header-filter-select",a.dataset.columnKey=t.key;const r=document.createElement("option");r.value="",r.textContent=g.allOption,a.appendChild(r),a.addEventListener("change",(()=>{V()})),e.appendChild(a);break;case"multiselect":const o=document.createElement("div");o.className="dt-header-multiselect",o.dataset.columnKey=t.key;const l=document.createElement("div");l.className="dt-multiselect-trigger";const i=document.createElement("span");i.className="dt-multiselect-value",i.textContent=g.allOption;const s=document.createElement("span");s.className="dt-multiselect-arrow",s.innerHTML="&#9660;",l.appendChild(i),l.appendChild(s);const c=document.createElement("div");c.className="dt-multiselect-dropdown",c.style.display="none",o.appendChild(l),o.appendChild(c),o.addEventListener("click",(e=>e.stopPropagation())),l.addEventListener("click",(e=>{const t="block"===c.style.display;N&&N.querySelectorAll(".dt-header-multiselect .dt-multiselect-dropdown").forEach((e=>{e!==c&&(e.style.display="none")})),c.style.display=t?"none":"block"})),e.appendChild(o)}a.appendChild(e)}e.appendChild(a)}})),Q()}function z(e){if("string"!=typeof e||!e.trim())return"";let t=e.trim().toLowerCase();return t.startsWith("fi-")&&(t=t.substring(3)),t}function _(e){if(O=e,Array.isArray(O))Y(),V();else{console.error(`[DynamicTable ${t}] Error: Provided data is not an array.`);const e=J();D&&(D.innerHTML=`<tr><td colspan="${e>0?e:1}" class="message-row error">${g.errorInvalidData}</td></tr>`)}}function G(e,t=null){const n=e.querySelectorAll('.dt-multiselect-item input[type="checkbox"]:checked'),a=e.querySelector(".dt-multiselect-value")||e.querySelector(".dt-custom-select-value");if(a)if(0===n.length)a.textContent=t?g.allOptionWithColumn.replace("{columnName}",t):g.allOption;else if(n.length<=2){let e=[];n.forEach((t=>e.push(t.value))),a.textContent=e.join(", ")}else a.textContent=g.itemsSelected.replace("{count}",n.length)}function Y(){Object.entries(K).forEach((([e,n])=>{const a=r.find((t=>t.key===e)),o=a?a.header:"";if(n.custom&&n.isGlobalMultiSelect){const a=n.optionsContainer;if(a&&O.length>0){a.innerHTML="";[...new Set(O.map((t=>t[e])))].filter((e=>null!=e&&""!==String(e).trim())).sort(((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:String(e).localeCompare(String(t)))).forEach((r=>{const l=`dt-gms-${t}-${e}-${String(r).replace(/\s+/g,"-")}`,i=document.createElement("div");i.className="dt-multiselect-item";const s=document.createElement("input");s.type="checkbox",s.id=l,s.value=r,s.dataset.filterKey=e;const c=document.createElement("label");c.htmlFor=l,c.textContent=r,i.appendChild(s),i.appendChild(c),a.appendChild(i),s.addEventListener("change",(()=>{const t=a.querySelectorAll('input[type="checkbox"]:checked');let r=[];t.forEach((e=>r.push(e.value))),K[e].value=r,G(n.mainElement,o),V()}))})),G(n.mainElement,o)}}else if(n.custom){const t=[...new Set(O.map((t=>z(t[e]))))].filter(Boolean).sort();!function(e,t,n,a,r){t.innerHTML="";const o=document.createElement("div");o.className="dt-custom-option",o.textContent=g.allOption,o.dataset.value="",o.addEventListener("click",(()=>{n.textContent=g.allOption,K[e].value="",t.style.display="none",t.closest(".dt-custom-select").classList.remove("open"),V()})),t.appendChild(o),a.forEach((a=>{const r=document.createElement("div");r.className="dt-custom-option",r.dataset.value=a,r.innerHTML=`<span class="fi fi-${a}"></span>`,r.addEventListener("click",(()=>{n.innerHTML=`<span class="fi fi-${a}"></span>`,K[e].value=a,t.style.display="none",t.closest(".dt-custom-select").classList.remove("open"),V()})),t.appendChild(r)}))}(e,n.optionsContainer,n.triggerValueElement,t)}else{const t=n.element;if(t){for(;t.options.length>1;)t.remove(1);[...new Set(O.map((t=>t[e])))].sort().forEach((e=>{if(null!=e){const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}}))}}})),N&&O.length>0&&r.forEach((e=>{if(e.filterable&&e.key)if("select"===e.headerFilterType){const t=N.querySelector(`.dt-header-filter-select[data-column-key="${e.key}"]`);if(t){for(;t.options.length>1;)t.remove(1);[...new Set(O.map((t=>t[e.key])))].filter((e=>null!=e&&""!==String(e).trim())).sort(((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:String(e).localeCompare(String(t)))).forEach((e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}))}}else if("multiselect"===e.headerFilterType){const n=N.querySelector(`.dt-header-multiselect[data-column-key="${e.key}"]`);if(n){const a=n.querySelector(".dt-multiselect-dropdown");if(a){a.innerHTML="";[...new Set(O.map((t=>t[e.key])))].filter((e=>null!=e&&""!==String(e).trim())).sort(((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:String(e).localeCompare(String(t)))).forEach((r=>{const o=`dt-ms-${t}-${e.key}-${String(r).replace(/\s+/g,"-")}`,l=document.createElement("div");l.className="dt-multiselect-item";const i=document.createElement("input");i.type="checkbox",i.id=o,i.value=r,i.dataset.columnKey=e.key;const s=document.createElement("label");s.htmlFor=o,s.textContent=r,l.appendChild(i),l.appendChild(s),a.appendChild(l),i.addEventListener("change",(()=>{G(n),V()}))})),G(n)}}}}))}function V(){let e;if("header"===y){const t={};N&&r.forEach((e=>{if(e.filterable&&e.headerFilterType&&e.key){const n=e.key;switch(e.headerFilterType){case"text":case"regex":const a=N.querySelector(`.dt-header-filter-input[data-column-key="${n}"]`);a&&a.value.trim()&&(t[n]={value:a.value.trim(),type:e.headerFilterType});break;case"select":const r=N.querySelector(`.dt-header-filter-select[data-column-key="${n}"]`);r&&r.value&&(t[n]={value:r.value,type:"select"});break;case"multiselect":const o=N.querySelector(`.dt-header-multiselect[data-column-key="${n}"]`);if(o){const e=o.querySelectorAll('.dt-multiselect-item input[type="checkbox"]:checked');if(e.length>0){let a=[];e.forEach((e=>a.push(e.value))),t[n]={values:a,type:"multiselect"}}}}}})),e=O.filter((e=>{for(const n in t){r.find((e=>e.key===n));const a=e[n],o=t[n],l=o.value,i=String(null!=a?a:"");if("text"===o.type||"regex"===o.type){const e=W(l);try{if(!new RegExp(e,"i").test(i))return!1}catch(t){return console.warn(`[DynamicTable] Invalid pattern/regex for column ${n}: ${l} (converted to ${e})`,t),!1}}else if("select"===o.type){if(i!==l)return!1}else if("multiselect"===o.type&&o.values&&o.values.length>0&&!o.values.includes(i))return!1}return!0}))}else{const t=w&&i?w.value.trim().toLowerCase():"",n={};Object.entries(K).forEach((([e,t])=>{t.custom?t.value&&(n[e]=t.value):t.element&&t.element.value&&(n[e]=t.element.value)})),e=O.filter((e=>!!Object.entries(n).every((([t,n])=>{const a=r.find((e=>e.key===t)),o=String(null!==e[t]&&void 0!==e[t]?e[t]:"");if(a&&"multiselect"===a.globalFilterType)return!(Array.isArray(n)&&n.length>0)||n.includes(o);if(a&&"flag"===a.format){const a=z(e[t]);return String(a)===n}return o===n}))&&(!i||!t||Object.values(e).some((e=>String(null!=e?e:"").toLowerCase().includes(t))))))}H&&e.sort(((e,t)=>{let n=e[H],a=t[H];const r=parseFloat(n),o=parseFloat(a);return isNaN(r)||isNaN(o)||"boolean"==typeof n||"boolean"==typeof a?(n=String(n).toLowerCase(),a=String(a).toLowerCase()):(n=r,a=o),n<a?"asc"===B?-1:1:n>a?"asc"===B?1:-1:0})),I=e,q=1,Z()}function Z(){if(!D)return;if(j&&j.length>0&&j.forEach((e=>{e&&"function"==typeof e._onMouseOut&&e._onMouseOut(),e&&e.tooltipElement&&e.tooltipElement.parentNode&&e.tooltipElement.parentNode.removeChild(e.tooltipElement)})),j=[],D.innerHTML="",0===I.length)return function(){const e=J();D&&(D.innerHTML=`<tr><td colspan="${e>0?e:1}" class="message-row no-results">${g.noResultsMsg}</td></tr>`)}(),c&&X(),void(k&&(k.textContent="0"));let e;e=c?b===1/0?I.length:Number(b):I.length;const n=0===e&&I.length>0?1:Math.ceil(I.length/e);q=Math.max(1,Math.min(q,n));const a=(q-1)*e,o=Math.min(a+e,I.length);if(I.slice(a,o).forEach(((e,n)=>{const o=D.insertRow();R.forEach(((l,i)=>{if(l.visible){const s=r.find((e=>e.key===l.key));if(!s)return void console.warn(`[DynamicTable] Column config not found for key: ${l.key}`);const c=o.insertCell();c.innerHTML="";const d=e[s.key];if("function"==typeof s.render)s.render(d,e,c);else if("chart"===s.renderAs&&s.chartConfig){c.classList.add("dt-chart-cell");const r=document.createElement("div");r.className="dt-chart-canvas-wrapper",c.appendChild(r);const o=`${t}-chart-${a+n}-${i}`,l=document.createElement("canvas");l.id=o,l.width=s.chartConfig.width||150,l.height=p||s.chartConfig.height||75,r.appendChild(l);const d=e[s.chartConfig.dataKey];if(d&&"undefined"!=typeof PureChart)try{const e=new PureChart(o,{type:s.chartConfig.type,data:d,options:s.chartConfig.options||{}});e&&j.push(e)}catch(e){console.error(`[DynamicTable] Error creating chart ${o}:`,e),c.textContent=g.errorChart}else"undefined"==typeof PureChart?(console.warn(`[DynamicTable] PureChart is not defined for column ${s.header}. Ensure PureChart.js is loaded.`),c.textContent=g.errorPureChartMissing):(console.warn(`[DynamicTable] Data for chart not found via dataKey '${s.chartConfig.dataKey}' for column ${s.header}.`),c.textContent=g.errorChartDataMissing)}else{const e=function(e,t){if(null==e)return"";if("number"!=typeof e&&(String(t).startsWith("currency:")||String(t).startsWith("percent")))return e;if("string"==typeof t){if(t.startsWith("currency:")){const n=t.split(":"),a=n[1]?n[1].toUpperCase():"EUR";let r="USD"===a?"en-US":"en-GB";n[2]&&(r=n[2]);try{return e.toLocaleString("en-US",{style:"currency",currency:a,useGrouping:!0}).replace(/,/g," ")}catch(t){return console.warn(`[DynamicTable] Currency formatting error for ${a} with locale 'en-US':`,t),e}}if(t.startsWith("percent")){if(t.includes("_neutral")&&0===e)return"";const n=t.replace("_neutral","").split(":"),a=n[1]?parseInt(n[1],10):0;return isNaN(a)||a<0?(100*e).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).replace(/,/g," ")+"%":(100*e).toLocaleString("en-US",{minimumFractionDigits:a,maximumFractionDigits:a}).replace(/,/g," ")+"%"}if("date:YYYY/MM/DD"===t){const t=new Date(e);return isNaN(t.getTime())?e:`${t.getFullYear()}/${("0"+(t.getMonth()+1)).slice(-2)}/${("0"+t.getDate()).slice(-2)}`}if("date"===t){const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-US")}if("flag"===t){if("string"==typeof e&&""!==e.trim()){let t=e.trim().toLowerCase();if(t.startsWith("fi-")&&(t=t.substring(3)),t.length>=2)return`<span class="fi fi-${t}"></span>`}return""}}return e}(d,s.format);"string"==typeof s.format&&s.format.startsWith("percent_neutral")&&"number"==typeof d&&0===d?c.innerHTML="":"flag"===s.format?c.innerHTML=e:c.textContent=e,"string"==typeof s.format&&s.format.startsWith("percent")&&!s.format.includes("_neutral")&&"number"==typeof d&&(c.classList.remove("dt-value-positive","dt-value-negative"),d>0?c.classList.add("dt-value-positive"):d<=0&&c.classList.add("dt-value-negative"))}}}))})),c&&X(),k&&k.parentNode){let e=I.length.toLocaleString("en-US");e=e.replace(/,/g," "),k.textContent=e;const t=k.nextSibling;t&&t.nodeType===Node.TEXT_NODE&&(t.textContent=` ${g.resultsInfo.replace("{count}","")}`)}}function X(){if(!(c&&$&&M&&x))return;const e=b===1/0?I.length:Number(b),t=I.length;let n;if(n=0===t||0===e||e>=t&&t>0?1:Math.ceil(t/e),q=Math.max(1,Math.min(q,n)),$.textContent=g.pageInfo.replace("{currentPage}",q).replace("{totalPages}",n),M.disabled=1===q,x.disabled=q===n||0===t,F){const e=b===1/0?"Infinity":String(b);for(let t=0;t<F.options.length;t++)if(F.options[t].value.toLowerCase()===e.toLowerCase()){F.selectedIndex=t;break}}}function Q(){N&&N.querySelectorAll("th.sortable").forEach((e=>{const t=e.querySelector(".sort-arrow");if(t&&t.remove(),e.dataset.column===H){const t=document.createElement("span");t.className="sort-arrow "+B;const n=e.querySelector(".dt-title-line");n?n.appendChild(t):e.appendChild(t)}}))}r.forEach((e=>{R.push({key:e.key,header:e.header,visible:void 0===e.visible||e.visible})})),function(){E.innerHTML="",E.classList.add("dynamic-table-wrapper"),P=document.createElement("div"),P.className="dynamic-table-controls";let e,n=!1;if(i){e=document.createElement("div"),e.className="dynamic-table-search-control";const a=document.createElement("label");a.htmlFor=`${t}-global-search`,a.textContent=g.globalSearchLabel,w=document.createElement("input"),w.type="search",w.id=`${t}-global-search`,w.placeholder=g.globalSearchPlaceholder,e.appendChild(a),e.appendChild(w),P.appendChild(e),n=!0}const a=[];r.forEach((e=>{if(e.filterable&&e.key){const r=document.createElement("div");r.className="dynamic-table-filter-control";const o=document.createElement("label");o.htmlFor=`${t}-filter-${e.key}`,o.textContent=g.filterByLabel.replace("{columnName}",e.header),r.appendChild(o);if("multiselect"===(e.globalFilterType||"select")){const t=document.createElement("div");t.className="dt-global-multiselect dt-custom-select",t.dataset.filterKey=e.key;const n=document.createElement("div");n.className="dt-custom-select-trigger";const a=document.createElement("span");a.className="dt-custom-select-value",a.textContent=g.allOptionWithColumn.replace("{columnName}",e.header);const o=document.createElement("span");o.className="dt-custom-arrow",o.innerHTML="&#9660;",n.appendChild(a),n.appendChild(o);const l=document.createElement("div");l.className="dt-custom-options",l.style.display="none",t.appendChild(n),t.appendChild(l),r.appendChild(t),K[e.key]={custom:!0,isGlobalMultiSelect:!0,mainElement:t,triggerValueElement:a,optionsContainer:l,value:[]}}else if("flag"===e.format){r.classList.add("custom-flag-filter");const n=document.createElement("div");n.id=`${t}-filter-${e.key}`,n.className="dt-custom-select",n.dataset.filterKey=e.key;const a=document.createElement("div");a.className="dt-custom-select-trigger";const o=document.createElement("span");o.className="dt-custom-select-value",o.textContent=g.allOption,a.appendChild(o);const l=document.createElement("span");l.className="dt-custom-arrow",l.innerHTML="&#9660;",a.appendChild(l),n.appendChild(a);const i=document.createElement("div");i.className="dt-custom-options",i.style.display="none",n.appendChild(i),r.appendChild(n),K[e.key]={custom:!0,isGlobalMultiSelect:!1,mainElement:n,triggerValueElement:o,optionsContainer:i,value:""}}else{const n=document.createElement("select");n.id=`${t}-filter-${e.key}`,n.dataset.filterKey=e.key,n.classList.add("dt-common-select");const a=document.createElement("option");a.value="",a.textContent=g.allOptionWithColumn.replace("{columnName}",e.header),n.appendChild(a),r.appendChild(n),K[e.key]={custom:!1,isGlobalMultiSelect:!1,element:n}}P.appendChild(r),a.push(r),n=!0}})),"header"===y&&(e&&(e.style.display="none"),a.forEach((e=>{e.style.display="none"})));const o=document.createElement("div");o.className="dynamic-table-right-controls-group";let l=!1;if(s){const e=document.createElement("div");e.className="dynamic-table-results-info",k=document.createElement("strong"),k.textContent="0",e.appendChild(k);const t=document.createTextNode("");e.appendChild(t),o.appendChild(e),l=!0}if(h&&(A=function(){const e=document.createElement("div");e.className="dynamic-table-column-selector";const n=document.createElement("button");n.innerHTML="&#x2699;",n.className="dt-column-selector-button",n.setAttribute("aria-label",g.columnSelectorAriaLabel),n.title=g.columnSelectorTitle,e.appendChild(n);const a=document.createElement("div");return a.className="dt-column-selector-dropdown",a.style.display="none",R.forEach((e=>{const n=`${t}-col-toggle-${e.key}`,r=document.createElement("div");r.className="dt-column-selector-item";const o=document.createElement("input");o.type="checkbox",o.id=n,o.checked=e.visible,o.dataset.columnKey=e.key,o.addEventListener("change",(function(){const e=this.dataset.columnKey,t=R.find((t=>t.key===e));t&&(t.visible=this.checked),U(),Y(),Z()}));const l=document.createElement("label");l.htmlFor=n,l.textContent=e.header,r.appendChild(o),r.appendChild(l),a.appendChild(r)})),e.appendChild(a),n.addEventListener("click",(e=>{e.stopPropagation();const t="block"===a.style.display;document.querySelectorAll(".dt-column-selector-dropdown").forEach((e=>{e!==a&&(e.style.display="none")})),a.style.display=t?"none":"block"})),document.addEventListener("click",(t=>{e.contains(t.target)||"block"!==a.style.display||(a.style.display="none")})),e}(),o.appendChild(A),l=!0),l&&(P.appendChild(o),n=!0),n&&E.appendChild(P),L=document.createElement("div"),L.className="dynamic-table-scroll-wrapper",m&&(L.style.maxHeight=m,L.style.overflowY="auto"),S=document.createElement("table"),S.className="dynamic-table",N=S.createTHead(),D=S.createTBody(),U(),L.appendChild(S),E.appendChild(L),c){T=document.createElement("div"),T.className="dynamic-table-pagination";const e=document.createElement("div");if(e.className="dynamic-table-pagination-left",d){const n=document.createElement("div");n.className="dynamic-table-rows-per-page-control";const a=document.createElement("label");a.htmlFor=`${t}-rows-per-page`,a.textContent=g.rowsPerPageLabel,F=document.createElement("select"),F.id=`${t}-rows-per-page`,F.classList.add("dt-common-select"),u.forEach((e=>{const t=document.createElement("option"),n=v(e);t.value=n?1/0:e,t.textContent=n?g.allRowsOptionLabel:String(e),(n&&b===1/0||!n&&Number(e)===Number(b))&&(t.selected=!0),F.appendChild(t)})),n.appendChild(a),n.appendChild(F),e.appendChild(n)}T.appendChild(e);const n=document.createElement("div");n.className="dynamic-table-main-pagination-controls",M=document.createElement("button"),M.textContent=g.previousButtonLabel,M.disabled=!0,n.appendChild(M),$=document.createElement("span"),$.textContent=g.pageInfo.replace("{currentPage}","1").replace("{totalPages}","1"),n.appendChild($),x=document.createElement("button"),x.textContent=g.nextButtonLabel,x.disabled=!0,n.appendChild(x),T.appendChild(n),E.appendChild(T)}}(),w&&w.addEventListener("input",V),document.addEventListener("click",(e=>{if(Object.values(K).forEach((t=>{t.custom&&t.mainElement.classList.contains("open")&&(t.mainElement.contains(e.target)||(t.mainElement.classList.remove("open"),t.optionsContainer&&(t.optionsContainer.style.display="none")))})),A){const t=A.querySelector(".dt-column-selector-dropdown");t&&"block"===t.style.display&&(A.contains(e.target)||(t.style.display="none"))}N&&N.querySelectorAll(".dt-header-multiselect").forEach((t=>{const n=t.querySelector(".dt-multiselect-dropdown");n&&"block"===n.style.display&&(t.contains(e.target)||(n.style.display="none"))}))})),Object.entries(K).forEach((([e,t])=>{if(t.custom){const e=t.mainElement,n=e.querySelector(".dt-custom-select-trigger"),a=t.optionsContainer;n&&a&&n.addEventListener("click",(t=>{t.stopPropagation();const n=e.classList.contains("open");Object.values(K).forEach((t=>{t.custom&&t.mainElement!==e&&(t.mainElement.classList.remove("open"),t.optionsContainer&&(t.optionsContainer.style.display="none"))})),e.classList.toggle("open",!n),a.style.display=n?"none":"block"}))}else t.element&&t.element.addEventListener("change",V)})),F&&F.addEventListener("change",(function(){const e=this.value;if("infinity"===e.toLowerCase())b=1/0;else if(b=parseInt(e,10),isNaN(b)||b<=0){const e=u[0];b=v(e)||"infinity"===String(e).toLowerCase()?1/0:Number(e)||10,b===1/0&&I&&I.length>0||b===1/0&&(b=10)}q=1,Z()})),N&&N.addEventListener("click",(e=>{const t=e.target,n=t.closest("th.sortable");if(!n)return;if(t.closest(".dt-header-filter-placeholder"))return;const a=n.dataset.column;a&&(H===a?B="asc"===B?"desc":"asc":(H=a,B="asc"),Q(),V())})),M&&M.addEventListener("click",(()=>{q>1&&(q--,Z())})),x&&x.addEventListener("click",(()=>{const e=b===1/0?I.length:Number(b);let t=1;I.length>0&&e>0?t=Math.ceil(I.length/e):0===I.length&&(t=1),q<t&&(q++,Z())})),a?_(a):n&&async function(){if(n){!function(){const e=J();D&&(D.innerHTML=`<tr><td colspan="${e>0?e:1}" class="message-row loading">${g.loadingMsg}</td></tr>`)}();try{const e=await fetch(n);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);_(await e.json())}catch(e){console.error(`[DynamicTable ${t}] Fetch error:`,e);const n=J();D&&(D.innerHTML=`<tr><td colspan="${n>0?n:1}" class="message-row error">${g.errorLoadingData}</td></tr>`),w&&(w.disabled=!0),Object.values(K).forEach((e=>e.disabled=!0)),M&&(M.disabled=!0),x&&(x.disabled=!0),F&&(F.disabled=!0)}}else{console.error(`[DynamicTable ${t}] Error: jsonPath not defined.`);const e=J();D&&(D.innerHTML=`<tr><td colspan="${e>0?e:1}" class="message-row error">${g.errorJsonPathNotDefined}</td></tr>`)}}()}